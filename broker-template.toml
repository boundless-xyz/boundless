### [Disclaimer] ###
# IMPORTANT: Running the broker with these settings will likely result in your
# broker not being able to lock or fulfill orders, and may even result in your
# broker being slashed.
#
# We strongly recommend using the Boundless CLI's `boundless prover
# generate-config` command to generate a broker.toml file that is tailored to
# your specific setup.
#
# Additionally, refer to documentation:
# https://docs.boundless.network/provers/broker#settings-in-brokertoml
### [End] ###

[market]
# Minimum price per mega-cycle. Can be specified in USD or ETH.
# If USD, it will be converted to the order's payment token (ETH) at runtime using the price oracle.
# Plain numbers without asset suffix default to ETH for backward compatibility.
#
# Examples: "0.00001 USD", "0.00000001 ETH", "0.00000001"
#
# Orders are preflighted (https://docs.boundless.network/provers/terminology#preflight)
# to determine the number of cycles required to prove the order. Based on this
# cycle count, and the current price of the order, the broker computes the
# current price per mega-cycle being offered for the order. This value is compared to the
# `min_mcycle_price` to determine if the order should be locked.
min_mcycle_price = "0.00002 USD"


# Per-requestor and per-selector min_mcycle_price overrides.
#
# Resolution priority: by_requestor_selector > by_selector > by_requestor > global default.
# Changes take effect immediately when the broker reloads this file.
#
# Uncomment and populate any of the sections below to enable overrides:
#
# [market.pricing_overrides.by_requestor]
# "0xAbC...123" = { min_mcycle_price = "0.0001 USD" }
#
# [market.pricing_overrides.by_selector]
# "0x12345678" = { min_mcycle_price = "0.0005 USD" }
#
# [market.pricing_overrides.by_requestor_selector]
# "0xAbC...123:0x12345678" = { min_mcycle_price = "0.001 USD" }

# The minimum price per mega-cycle (i.e. million RISC-V cycles) for the broker
# to attempt to fulfill an order in the case that the order was locked by another prover
# but not fulfilled within the lock timeout.
#
# If an order is locked by a prover, but not fulfilled within the lock timeout,
# that prover is slashed by the amount of collateral specified in the order. A
# portion of this collateral is then used to incentivize other provers to
# fulfill the order. `min_mcycle_price_collateral_token` determines the minimum
# price per mega-cycle in collateral token that must be offered by the prover
# for the broker to attempt to fulfill these orders.
#
# Can be specified in USD or ZKC.
# Plain numbers default to ZKC for backward compatibility.
# If USD, converted to ZKC at runtime via price oracle.

# Examples: "0.00005 ZKC", "0.00001 USD", "0.00005"
#
# Note: attempting to fulfill these orders is a 'proof race' where the first prover
# to fulfill the order is rewarded with the collateral.
min_mcycle_price_collateral_token = "0.00005 ZKC"

# Estimated peak performance of the proving cluster, in kHz.
#
# Used to estimate proving capacity and accept only as much work as your prover
# cluster can handle. Estimates can be derived from benchmarking using the
# Boundless CLI. For more information, see:
# https://docs.beboundless.xyz/provers/broker#benchmarking-bento
peak_prove_khz = 100

# Requestor priority lists specify requestors that the broker should
# prioritize for proving. Requestors on these lists are considered more likely
# to request useful work with profitable pricing, and thus are prioritized over
# requestors not on these lists.
#
# Priority requestors are prioritized when there is a surplus of demand, and skip 
# various limits that are typically applied to all requestors:
# 1. Their requests will be preflighted first.
# 2. Their requests will be locked first (in situations where multiple orders
#    exceed minimum lock pricing).
# 3. Configuration for `max_mcycle_limit` and `max_file_size` will be skipped.
priority_requestor_lists = [
	"https://requestors.boundless.network/boundless-recommended-priority-list.standard.json",
]

# Maximum collateral amount that the broker will use to lock orders.
# Can be specified in USD or ZKC.
# Plain numbers default to ZKC for backward compatibility.
# If USD, it will be converted to ZKC at runtime using the price oracle.
#
# Examples: "100 USD", "200 ZKC", "200"
#
# Requests that require a higher collateral amount than this will be skipped.
max_collateral = "10 USD"

# Maximum number of orders to concurrently preflight.
#
# Used to limit preflight tasks spawned to prevent overwhelming the system.
# We recommend using the Boundless CLI's `boundless prover generate-config`
# to help configure this value.
#
# Refer to the broker configuration documentation for more information:
# https://docs.boundless.network/provers/broker#settings-in-brokertoml
max_concurrent_preflights = 2

# Maximum number of concurrent proofs that can be processed at once.
#
# Used to limit proof tasks spawned to prevent overwhelming the system.
max_concurrent_proofs = 1

# =============================================================================
# Price Oracle Configuration
# =============================================================================
# The price oracle is used to convert between ETH, ZKC and USD prices dynamically.
# By default, it uses Chainlink (on-chain) and CoinGecko (off-chain) sources.
#
# You can configure each trading pair independently to use either:
# - "auto": Fetch prices dynamically from configured sources (default)
# - A static value: e.g., "2500.00" for ETH/USD or "1.00" for ZKC/USD

[price_oracle]
# ETH/USD price configuration
# Default: "auto" (fetches dynamically from Chainlink + CoinGecko)
# Example static value: eth_usd = "2500.00"
eth_usd = "auto"

# ZKC/USD price configuration
# Default: "auto" (fetches dynamically from Chainlink + CoinGecko)
# Example static value: zkc_usd = "1.00"
zkc_usd = "auto"

# Advanced options (usually don't need to be changed)
# refresh_interval_secs = 60          # How often to refresh cached prices (default: 60)
# timeout_secs = 10                   # HTTP/RPC timeout for price fetching (default: 10)
# aggregation_mode = "median"         # How to combine sources: "priority", "median", or "average" (default: "median")
# min_sources = 1                     # Minimum successful sources required (default: 1)
# max_secs_without_price_update = 43200  # Max seconds without a price update before logging error; 0 to disable (default: 43200 / 12h)

# On-chain price sources
# [price_oracle.onchain.chainlink]
# enabled = true                      # Use Chainlink price feeds (default: true)

# Off-chain price sources
# [price_oracle.offchain.coingecko]
# enabled = true                      # Use CoinGecko API (default: true, free tier)
# api_key = ""                        # Optional API key for CoinGecko Pro

# [price_oracle.offchain.cmc]
# enabled = false                     # Use CoinMarketCap API (default: false)
# api_key = "your-api-key"            # Required for CoinMarketCap
