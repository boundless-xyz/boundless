---
# Vector installation
vector_install: true

# Vector service configuration
vector_service_enabled: true  # enabled by default
vector_service_state: started  # started by default

# Vector configuration
vector_config_dir: "/etc/vector"
vector_config_file: "/etc/vector/vector.yaml"

# CloudWatch Logs configuration
# Can be overridden in group_vars or host_vars to match existing log groups
# Example: "/boundless/bento/dev" or "/boundless/bento/{{ stack_name }}"
vector_cloudwatch_log_group: "/boundless/bento/{{ hostvars[inventory_hostname]['ansible_hostname'] }}"
vector_cloudwatch_region: "us-west-2"
vector_cloudwatch_stream_name: "%Y-%m-%d"

# AWS Authentication
# Vector will use credentials in this order:
# 1. IAM instance profile (if running on EC2) - preferred method
# 2. AWS credentials file (~/.aws/credentials) - if vector_aws_credentials_file is set
# 3. Environment variables in /etc/default/vector - if vector_aws_access_key_id and vector_aws_secret_access_key are set
vector_aws_use_instance_profile: true  # Use IAM instance profile (preferred for EC2)
vector_aws_credentials_file: null  # Path to AWS credentials file (e.g., "/root/.aws/credentials")
vector_aws_access_key_id: null  # AWS access key ID (not recommended, use IAM roles instead)
vector_aws_secret_access_key: null  # AWS secret access key (not recommended, use IAM roles instead)

# Services to monitor (systemd units)
vector_monitor_services:
  - bento.service

# Vector buffer configuration
vector_buffer_type: "memory"
vector_buffer_max_size: 268435488  # 256MB
vector_buffer_when_full: "block"

# Vector log level
vector_log_level: "info"

# Host metrics collection
vector_collect_host_metrics: true  # Enable system metrics collection (CPU, memory, disk, network)
vector_host_metrics_collectors:
  - memory
  - disk
  - filesystem
vector_metrics_scrape_interval: 15  # Scrape interval in seconds

# Filesystem collector configuration
# By default, explicitly include root filesystem (/) to ensure it's tracked
# To include additional mountpoints or devices, add them to the lists below
vector_filesystem_devices_includes: []  # Empty list means include all (default: ["*"])
vector_filesystem_devices_excludes: []  # Exclude specific device patterns (e.g., ["loop*"])
vector_filesystem_mountpoints_includes: ["/"]  # Explicitly include root filesystem
vector_filesystem_mountpoints_excludes: []  # Exclude specific mountpoint patterns (e.g., ["/proc", "/sys"])

# CloudWatch Metrics configuration
# Metrics will be published to CloudWatch Metrics with this namespace
vector_cloudwatch_metrics_namespace: "Boundless/SystemMetrics"

# Bento process and container tracking (gauges: bento_active 0|1, bento_containers count)
vector_track_bento_process: true
vector_bento_process_interval_secs: 60

# Log error metrics (counter: bento_log_errors, incremented per ERROR line in journald)
vector_track_log_errors: true

# Kailua process tracking (enable on hosts running kailua.service)
vector_track_kailua_process: false
vector_kailua_process_interval_secs: 60
# kailua_log_age_secs gauge: seconds since the last kailua.service log line.
# Set a CloudWatch alarm on this metric exceeding the threshold below to detect
# a stalled prover (no proof activity for too long).
vector_kailua_stale_threshold_secs: 7200  # 2 hours
