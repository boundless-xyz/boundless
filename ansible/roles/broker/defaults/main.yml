---
# Broker version to install
broker_version: "v1.1.1"
# Service user (uses bento_user from bento role)
# These default to "bento" if bento_user is not defined
broker_user: "{{ bento_user | default('bento') }}"
broker_group: "{{ bento_group | default('bento') }}"
broker_home: "{{ bento_home | default('/var/lib/bento') }}"
broker_rust_log: "info"
# Service timeouts
broker_timeout_start_sec: 1800
broker_timeout_stop_sec: 300

# Installation paths
broker_install_dir: "/usr/local/bin"
broker_config_dir: "/etc/boundless/broker"
broker_work_dir: "/etc/boundless/broker"

# Broker configuration file
broker_config_file: "{{ broker_config_dir }}/broker.toml"

# Database configuration
broker_db_url: "sqlite://{{ broker_config_dir }}/broker.db"
broker_db_type: "sqlite"  # sqlite or postgresql

# Bento API configuration
# Environment variable: BROKER_BENTO_API_URL
# Note: default(..., true) handles empty strings from env vars
broker_bento_api_url: "http://localhost:8081"

# Ethereum RPC configuration
# Environment variable: BROKER_RPC_URL or RPC_URL
broker_rpc_url: "{{ lookup('env', 'BROKER_RPC_URL') | default(lookup('env', 'RPC_URL') | default('', true), true) | string }}"

# Private key configuration
# Environment variable: BROKER_PRIVATE_KEY or PRIVATE_KEY
broker_private_key: "{{ lookup('env', 'BROKER_PRIVATE_KEY') | default(lookup('env', 'PRIVATE_KEY') | default('', true), true) | string }}"

# Prometheus metrics configuration
# Uses port 9590 to avoid conflicts with Bento services
broker_prometheus_metrics_addr: "127.0.0.1:9590"

# Broker TOML configuration
broker_min_mcycle_price: "0.00000001"
broker_min_mcycle_price_collateral_token: "0.00005"
broker_peak_prove_khz: 100
broker_max_collateral: "200"
broker_max_concurrent_preflights: 2
broker_max_concurrent_proofs: 1
broker_max_journal_bytes: 20000
broker_priority_requestor_lists:
  - "https://requestors.boundless.network/boundless-recommended-priority-list.standard.json"

# Optional allow list for client addresses.
#
# If enabled, all requests from clients not in the allow list are skipped.
broker_allow_client_addresses: []

# Maximum files size in bytes
#
# Orders with a file larger than this will be skipped.
broker_max_file_size: 500000000000

# Service management
broker_service_enabled: true
broker_service_state: started
