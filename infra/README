# Onboarding for development deployments

This is a one time setup that enables you to deploy applications to a development AWS accout for testing.
This bootstraps the account with your personal VPC.

1. `cd infra/bootstrap`
2. `export DEV_NAME="<your name>"`
3. `pulumi login --local`
4. `pulumi stack select staging-dev`
5. `pulumi up`

# Creating a new project

These steps create a new project with a dev stack for deploying to the development account.

1. Vault in as developer admin
2. `pulumi login --local`
3. `pulumi new aws-typescript --name <project_name> --stack dev --yes`
4. `git add -u && git commit -m "Initialize <project_name>"`
5. Add `Pulumi.dev.yaml` to `.gitignore`
6. `git add -u && git commit -m ".gitignore"`

## Deploying to staging and prod

Once the dev stack is stable, these steps create staging and prod stacks in preparation for deployment to the staging/prod environments.

Requires Ops Admin permissions. Create staging and prod stacks requires accessing the Pulumi state bucket and Pulumi KMS key for encrypting secrets.

7. `pulumi login s3://boundless-pulumi-state?region=us-west-2&awssdk=v2&profile=aws-profile` 
8. `pulumi stack init --secrets-provider="awskms:///arn:aws:kms:us-west-2:968153779208:alias/pulumi-secrets-key" staging`
9. `pulumi stack init --secrets-provider="awskms:///arn:aws:kms:us-west-2:968153779208:alias/pulumi-secrets-key" prod`